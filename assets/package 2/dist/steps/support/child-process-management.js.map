{"version":3,"sources":["../../../src/steps/support/child-process-management.js"],"names":["Before","After","runner","eventBroadcaster","childConsoleLog","timeout","Runner","maxConnectTimeout","waitForServerUnavailable","err","console","log","message","emit","start","waitForServerAvailable","result","stop","consoleLog"],"mappings":";;AAAA;;AACA;;;;AAEA,iCAAkB,UAAU,EAAEA,MAAF,EAAUC,KAAV,EAAiBC,MAAjB,EAAyBC,gBAAzB,EAAV,EAAuD;AACvE,MAAIC,eAAJ;;AAEAJ,SAAO,EAAEK,SAAS,IAAIC,eAAOC,iBAAtB,EAAP,oBAAkD,aAAkB;AAClE,QAAI;AACF,YAAML,OAAOM,wBAAP,EAAN;AACD,KAFD,CAEE,OAAOC,GAAP,EAAY;AACZC,cAAQC,GAAR,CAAYF,IAAIG,OAAhB;AACAT,uBAAiBU,IAAjB,CAAsB,OAAtB;AACD;;AAEDT,sBAAkBF,OAAOY,KAAP,EAAlB;AACA,UAAMZ,OAAOa,sBAAP,EAAN;AACD,GAVD;;AAYAd;AAAA,kCAAM,WAAgB,EAAEe,MAAF,EAAhB,EAA4B;AAChC,YAAMd,OAAOe,IAAP,EAAN;AACAD,aAAOE,UAAP,GAAoB,MAAMd,eAA1B;AACD,KAHD;;AAAA;AAAA;AAAA;AAAA;AAID,CAnBD","file":"child-process-management.js","sourcesContent":["import { defineSupportCode } from 'cucumber';\nimport { Runner } from '../../lib/runner';\n\ndefineSupportCode(function ({ Before, After, runner, eventBroadcaster }) {\n  let childConsoleLog;\n\n  Before({ timeout: 3 * Runner.maxConnectTimeout }, async function () {\n    try {\n      await runner.waitForServerUnavailable();\n    } catch (err) {\n      console.log(err.message);\n      eventBroadcaster.emit('abort');\n    }\n\n    childConsoleLog = runner.start();\n    await runner.waitForServerAvailable();\n  });\n\n  After(async function ({ result }) {\n    await runner.stop();\n    result.consoleLog = await childConsoleLog;\n  });\n});\n"]}